<div class="max-w-3xl mx-auto px-4 py-8">
  <div class="mb-6">
    <%= link_to "â† Back to TV Show", admin_tv_show_path(@tv_show),
        class: "text-red-500 hover:text-red-400 inline-flex items-center" %>
  </div>

  <div class="bg-gray-800 rounded-lg shadow-lg p-6">
    <h1 class="text-2xl font-bold text-white mb-6">Edit TV Show</h1>

    <%= form_with model: [:admin, @tv_show], local: true, class: "space-y-6" do |form| %>
      
      <% if @tv_show.errors.any? %>
        <div class="bg-red-900 border border-red-700 rounded-lg p-4">
          <h2 class="text-red-200 font-semibold"><%= pluralize(@tv_show.errors.count, "error") %> prohibited this TV show from being saved:</h2>
          <ul class="mt-2 text-red-300 list-disc list-inside">
            <% @tv_show.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <%= form.label :title, class: "block text-sm font-medium mb-2" %>
          <%= form.text_field :title, required: true, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        </div>
        
        <div>
          <%= form.label :release_year, class: "block text-sm font-medium mb-2" %>
          <%= form.number_field :release_year, required: true, min: 1900, max: Date.current.year + 5, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <%= form.label :seasons, class: "block text-sm font-medium mb-2" %>
          <%= form.number_field :seasons, required: true, min: 1, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        </div>
        
        <div>
          <%= form.label :episodes, class: "block text-sm font-medium mb-2" %>
          <%= form.number_field :episodes, required: true, min: 1, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <%= form.label :genre_id, "Genre", class: "block text-sm font-medium mb-2" %>
          <%= form.select :genre_id, options_from_collection_for_select(@genres, "id", "name", @tv_show.genre_id), { include_blank: "Select Genre" }, { class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" } %>
        </div>
        
        <div>
          <%= form.label :imdb_rating, class: "block text-sm font-medium mb-2" %>
          <%= form.number_field :imdb_rating, step: 0.1, min: 0, max: 10, value: @tv_show.imdb_rating, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <%= form.label :country, class: "block text-sm font-medium mb-2" %>
          <%= form.text_field :country, value: @tv_show.country, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        </div>
        
        <div>
          <%= form.label :poster_url, "Poster URL", class: "block text-sm font-medium mb-2" %>
          <%= form.url_field :poster_url, value: @tv_show.poster_url, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
          <p class="text-sm text-gray-400 mt-1">Direct image URL (optional if uploading file)</p>
        </div>
      </div>

      <div>
        <%= form.label :trailer_url, "Trailer URL", class: "block text-sm font-medium mb-2" %>
        <%= form.url_field :trailer_url, value: @tv_show.trailer_url, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
        <p class="text-sm text-gray-400 mt-1">YouTube or other video URL</p>
      </div>

      <div>
        <%= form.label :description, class: "block text-sm font-medium mb-2" %>
        <%= form.text_area :description, rows: 4, value: @tv_show.description, class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <%= form.label :thumbnail, "TV Show Thumbnail", class: "block text-sm font-medium mb-2" %>
          <% if @tv_show.thumbnail.attached? %>
            <div class="mb-2">
              <p class="text-sm text-green-400">Current thumbnail uploaded (<%= number_to_human_size(@tv_show.thumbnail.blob.byte_size) %>)</p>
              <%= image_tag @tv_show.thumbnail.variant(resize_to_limit: [100, 150]), class: "mt-2 rounded" %>
            </div>
          <% end %>
          <%= form.file_field :thumbnail, accept: 'image/*', class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
          <p class="text-sm text-gray-400 mt-1">Upload a new poster image (PNG, JPG, JPEG - Max 5MB)</p>
          <% if @tv_show.thumbnail.attached? %>
            <p class="text-sm text-yellow-400 mt-1">Leave blank to keep current thumbnail</p>
          <% end %>
        </div>
        
        <div>
          <%= form.label :video, "TV Show Video", class: "block text-sm font-medium mb-2" %>
          <% if @tv_show.video.attached? %>
            <div class="mb-2">
              <p class="text-sm text-green-400">Current video uploaded (<%= number_to_human_size(@tv_show.video.blob.byte_size) %>)</p>
              <% if @tv_show.display_video_url %>
                <div class="mt-2">
                  <video controls class="w-full max-w-xs" preload="metadata">
                    <source src="<%= @tv_show.display_video_url %>" type="video/mp4">
                    Your browser does not support the video tag.
                  </video>
                </div>
              <% end %>
            </div>
          <% end %>
          <%= form.file_field :video, accept: 'video/*', class: "w-full bg-gray-700 text-white rounded px-4 py-2 focus:outline-none focus:ring-2 focus:ring-red-500" %>
          <p class="text-sm text-gray-400 mt-1">Upload a new video file (MP4, AVI, MOV - Max 100MB)</p>
          <% if @tv_show.video.attached? %>
            <p class="text-sm text-yellow-400 mt-1">Leave blank to keep current video</p>
          <% end %>
        </div>
      </div>

      <div class="flex justify-end space-x-4 pt-6 border-t border-gray-700">
        <%= link_to "Cancel", admin_tv_show_path(@tv_show), class: "px-6 py-2 border border-gray-600 text-gray-300 rounded-md hover:bg-gray-700" %>
        <%= form.submit "Update TV Show", class: "px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 cursor-pointer" %>
      </div>
    <% end %>
  </div>
</div>